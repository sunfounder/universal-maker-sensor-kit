.. note::

    ã“ã‚“ã«ã¡ã¯ã€SunFounder Raspberry Pi & Arduino & ESP32 Enthusiasts Communityã¸ã‚ˆã†ã“ãï¼Facebookä¸Šã§ã€ä»²é–“ã¨ä¸€ç·’ã«Raspberry Piã€Arduinoã€ESP32ã‚’ã•ã‚‰ã«æ·±ãæŽ¢æ±‚ã—ã¾ã—ã‚‡ã†ã€‚

    **ãªãœå‚åŠ ã™ã‚‹ã®ã‹ï¼Ÿ**

    - **å°‚é–€çš„ãªã‚µãƒãƒ¼ãƒˆ**ï¼šè³¼å…¥å¾Œã®å•é¡Œã‚„æŠ€è¡“çš„ãªèª²é¡Œã‚’ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã‚„ãƒãƒ¼ãƒ ã®åŠ©ã‘ã‚’å€Ÿã‚Šã¦è§£æ±ºã€‚
    - **å­¦ã³ã¨å…±æœ‰**ï¼šã‚¹ã‚­ãƒ«ã‚’å‘ä¸Šã•ã›ã‚‹ãŸã‚ã®ãƒ’ãƒ³ãƒˆã‚„ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚’äº¤æ›ã€‚
    - **é™å®šãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼**ï¼šæ–°è£½å“ç™ºè¡¨ã‚„äºˆå‘Šç·¨ã«æ—©æœŸã‚¢ã‚¯ã‚»ã‚¹ã€‚
    - **ç‰¹åˆ¥å‰²å¼•**ï¼šæœ€æ–°è£½å“ã®ç‰¹åˆ¥å‰²å¼•ã‚’æ¥½ã—ã‚€ã€‚
    - **ãƒ•ã‚§ã‚¹ãƒ†ã‚£ãƒ–ãƒ—ãƒ­ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³ã¨ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆ**ï¼šãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆã‚„ãƒ›ãƒªãƒ‡ãƒ¼ãƒ—ãƒ­ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³ã«å‚åŠ ã€‚

    ðŸ‘‰ ç§ãŸã¡ã¨ä¸€ç·’ã«æŽ¢ç´¢ã¨å‰µé€ ã‚’å§‹ã‚ã‚‹æº–å‚™ã¯ã§ãã¾ã—ãŸã‹ï¼Ÿ[|link_sf_facebook|]ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã€ä»Šã™ãå‚åŠ ã—ã¾ã—ã‚‡ã†ï¼

.. _pi_lesson06_hall_sensor:

ãƒ¬ãƒƒã‚¹ãƒ³ 06: ãƒ›ãƒ¼ãƒ«ã‚»ãƒ³ã‚µãƒ¼ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
==================================

.. note::
   Raspberry Piã«ã¯ã‚¢ãƒŠãƒ­ã‚°å…¥åŠ›æ©Ÿèƒ½ãŒãªã„ãŸã‚ã€ã‚¢ãƒŠãƒ­ã‚°ä¿¡å·ã‚’å‡¦ç†ã™ã‚‹ã«ã¯ :ref:`cpn_pcf8591` ã®ã‚ˆã†ãªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒå¿…è¦ã§ã™ã€‚

ã“ã®ãƒ¬ãƒƒã‚¹ãƒ³ã§ã¯ã€Raspberry Piã‚’ä½¿ç”¨ã—ã¦ãƒ›ãƒ¼ãƒ«ã‚»ãƒ³ã‚µãƒ¼ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‹ã‚‰èª­ã¿å–ã‚‹æ–¹æ³•ã‚’å­¦ã³ã¾ã™ã€‚ãƒ•ã‚©ãƒˆãƒ¬ã‚¸ã‚¹ã‚¿ãƒ¼ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’PCF8591ã«æŽ¥ç¶šã—ã¦ã‚¢ãƒŠãƒ­ã‚°ã‹ã‚‰ãƒ‡ã‚¸ã‚¿ãƒ«ã¸ã®å¤‰æ›ã‚’è¡Œã„ã€Pythonã‚’ä½¿ç”¨ã—ã¦ãã®å‡ºåŠ›ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ç›£è¦–ã™ã‚‹æ–¹æ³•ã‚’å­¦ã³ã¾ã™ã€‚ã•ã‚‰ã«ã€ã‚¢ãƒŠãƒ­ã‚°å€¤ã‚’èª­ã¿å–ã‚Šã€ãã‚Œã‚‰ã‚’è§£é‡ˆã—ã¦ç£æ¥µã®å­˜åœ¨ã¨ç¨®é¡žã‚’æ¤œå‡ºã™ã‚‹æ–¹æ³•ã‚‚æŽ¢ã‚Šã¾ã™ã€‚

å¿…è¦ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
--------------------------

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€ä»¥ä¸‹ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒå¿…è¦ã§ã™ã€‚

ä¸€å¼æƒã£ãŸã‚­ãƒƒãƒˆã‚’è³¼å…¥ã™ã‚‹ã¨ä¾¿åˆ©ã§ã™ã€‚ãƒªãƒ³ã‚¯ã¯ã“ã¡ã‚‰:

.. list-table::
    :widths: 20 20 20
    :header-rows: 1

    *   - Name	
        - ITEMS IN THIS KIT
        - LINK
    *   - Universal Maker Sensor Kit
        - 94
        - |link_umsk|

ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯ã‹ã‚‰å€‹åˆ¥ã«è³¼å…¥ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

.. list-table::
    :widths: 30 20
    :header-rows: 1

    *   - Component Introduction
        - Purchase Link

    *   - Raspberry Pi 5
        - \-
    *   - :ref:`cpn_hall`
        - \-
    *   - :ref:`cpn_pcf8591`
        - |link_pcf8591_module_buy|
    *   - :ref:`cpn_breadboard`
        - |link_breadboard_buy|


é…ç·š
---------------------------

.. image:: img/Lesson_06_Hall_Sensor_Module_pi_bb.png
    :width: 100%


ã‚³ãƒ¼ãƒ‰
---------------------------

.. code-block:: python

   import PCF8591 as ADC  # Import PCF8591 module
   import time  # Import time for delay
   
   ADC.setup(0x48)  # Initialize PCF8591 at address 0x48
   
   try:
       while True:  # Continuously read and print
           sensor_value = ADC.read(1) # Read from hall sensor module at AIN1
           print(sensor_value,end="")  # Print the sensor raw data
   
           # Determine the polarity of the magnet
           if sensor_value >= 180:
               print(" - South pole detected")   # Determined as South pole.
           elif sensor_value <= 80:
               print(" - North pole detected")   # Determined as North pole.
   
           time.sleep(0.2)  # Wait for 0.2 seconds before the next read
   
   except KeyboardInterrupt:
       print("Exit")  # Exit on CTRL+C
       
ã‚³ãƒ¼ãƒ‰è§£æž
---------------------------

#. **ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆ**:

   .. code-block:: python
      
      import PCF8591 as ADC  # Import PCF8591 module
      import time  # Import time for delay

   å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã™ã€‚ ``PCF8591`` ã¯ADCãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ã®å¯¾è©±ã«ä½¿ç”¨ã•ã‚Œã€ ``time`` ã¯ãƒ«ãƒ¼ãƒ—å†…ã§é…å»¶ã‚’å®Ÿè£…ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

#. **ADCãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®åˆæœŸåŒ–**:

   .. code-block:: python
      
      ADC.setup(0x48)  # Initialize PCF8591 at address 0x48

   PCF8591ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã—ã¾ã™ã€‚ ``0x48`` ã¯PCF8591ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®I2Cã‚¢ãƒ‰ãƒ¬ã‚¹ã§ã™ã€‚ã“ã®è¡Œã§ã€Raspberry PiãŒãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨é€šä¿¡ã§ãã‚‹ã‚ˆã†ã«æº–å‚™ã—ã¾ã™ã€‚

#. **ã‚»ãƒ³ã‚µãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿å–ã‚‹ãƒ¡ã‚¤ãƒ³ãƒ«ãƒ¼ãƒ—**:

   .. code-block:: python

      try:
          while True:  # Continuously read and print
              sensor_value = ADC.read(1) # Read from hall sensor module at AIN1
              print(sensor_value, end="")  # Print the sensor raw data

   ã“ã®ãƒ«ãƒ¼ãƒ—ã§ã¯ã€ ``sensor_value`` ãŒãƒ›ãƒ¼ãƒ«ã‚»ãƒ³ã‚µãƒ¼ï¼ˆPCF8591ã®AIN1ã«æŽ¥ç¶šï¼‰ã‹ã‚‰ç¶™ç¶šçš„ã«èª­ã¿å–ã‚‰ã‚Œã¾ã™ã€‚ ``print`` ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã¯ã€ç”Ÿã®ã‚»ãƒ³ã‚µãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’å‡ºåŠ›ã—ã¾ã™ã€‚

#. **ç£æ¥µã®åˆ¤å®š**:

   .. code-block:: python
      
              # Determine the polarity of the magnet
              if sensor_value >= 180:
                  print(" - South pole detected")   # Determined as South pole.
              elif sensor_value <= 80:
                  print(" - North pole detected")   # Determined as North pole.

   ã“ã“ã§ã¯ã€ç£çŸ³ã®æ¥µæ€§ã‚’åˆ¤å®šã—ã¾ã™ã€‚ ``sensor_value`` ãŒ180ä»¥ä¸Šã®å ´åˆã¯å—æ¥µã¨åˆ¤æ–­ã•ã‚Œã€80ä»¥ä¸‹ã®å ´åˆã¯åŒ—æ¥µã¨è¦‹ãªã•ã‚Œã¾ã™ã€‚ã“ã‚Œã‚‰ã®ã—ãã„å€¤ã¯ã€å®Ÿéš›ã®æ¸¬å®šçµæžœã«åŸºã¥ã„ã¦èª¿æ•´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

   ãƒ›ãƒ¼ãƒ«ã‚»ãƒ³ã‚µãƒ¼ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯49Eãƒªãƒ‹ã‚¢ãƒ›ãƒ¼ãƒ«åŠ¹æžœã‚»ãƒ³ã‚µãƒ¼ã‚’æ­è¼‰ã—ã¦ãŠã‚Šã€ç£å ´ã®åŒ—æ¥µã¨å—æ¥µã®æ¥µæ€§ã ã‘ã§ãªãã€ç£å ´ã®ç›¸å¯¾çš„ãªå¼·ã•ã‚‚æ¸¬å®šã§ãã¾ã™ã€‚49Eã¨è¨˜ã•ã‚ŒãŸå´ï¼ˆæ–‡å­—ãŒåˆ»ã¾ã‚Œã¦ã„ã‚‹å´ï¼‰ã«ç£çŸ³ã®å—æ¥µã‚’è¿‘ã¥ã‘ã‚‹ã¨ã€ã‚³ãƒ¼ãƒ‰ãŒèª­ã¿å–ã‚‹å€¤ã¯é©ç”¨ã•ã‚ŒãŸç£å ´ã®å¼·ã•ã«æ¯”ä¾‹ã—ã¦ç›´ç·šçš„ã«å¢—åŠ ã—ã¾ã™ã€‚é€†ã«ã€åŒ—æ¥µã‚’ã“ã®å´ã«è¿‘ã¥ã‘ã‚‹ã¨ã€ã‚³ãƒ¼ãƒ‰ãŒèª­ã¿å–ã‚‹å€¤ã¯ãã®ç£å ´ã®å¼·ã•ã«æ¯”ä¾‹ã—ã¦ç›´ç·šçš„ã«æ¸›å°‘ã—ã¾ã™ã€‚è©³ç´°ã«ã¤ã„ã¦ã¯ :ref:`cpn_hall` ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

#. **é…å»¶ã¨ä¾‹å¤–å‡¦ç†**:

   .. code-block:: python

      time.sleep(0.2)  # Wait for 0.2 seconds before the next read

      except KeyboardInterrupt:
          print("Exit")  # Exit on CTRL+C

``time.sleep(0.2)``ã¯å„ãƒ«ãƒ¼ãƒ—ã®åå¾©é–“ã«0.2ç§’ã®é…å»¶ã‚’ä½œã‚Šã€éŽå‰°ãªèª­ã¿å–ã‚Šé€Ÿåº¦ã‚’é˜²ãŽã¾ã™ã€‚ ``except`` ãƒ–ãƒ­ãƒƒã‚¯ã¯ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰å‰²ã‚Šè¾¼ã¿ï¼ˆCTRL+Cï¼‰ã‚’ã‚­ãƒ£ãƒƒãƒã—ã¦ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’é©åˆ‡ã«çµ‚äº†ã•ã›ã¾ã™ã€‚